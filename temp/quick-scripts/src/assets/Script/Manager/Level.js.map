{"version":3,"sources":["assets\\Script\\Manager\\Level.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport GameController from \"../Controller/GameController\";\nimport UIController from \"../Controller/UIController\";\nimport Utils from \"../Controller/Utils\";\nimport BaneOfRegeneration from \"../Item/BaneOfRegeneration\";\nimport BloodyTear from \"../Item/BloodyTear\";\nimport Dumbbell from \"../Item/Dumbbell\";\nimport EyePatch from \"../Item/EyePatch\";\nimport GrowthPill from \"../Item/GrowthPill\";\nimport HastePotion from \"../Item/HastePotion\";\nimport MightyStone from \"../Item/MightyStone\";\nimport Shield from \"../Item/Shield\";\nimport WisdomStone from \"../Item/WisdomStone\";\nimport OverallStats from \"../Player/OverallStats\";\nimport AxeThrower from \"../Weapon/AxeThrower\";\nimport Bow from \"../Weapon/Bow\";\nimport Melee from \"../Weapon/Melee\";\nimport MollyThrower from \"../Weapon/MollyThrower\";\nimport ShurikenThrower from \"../Weapon/ShurikenThrower\";\nimport Sword from \"../Weapon/Sword\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Level extends cc.Component {\n  static instance: Level;\n\n  @property(cc.Integer)\n  level: number = 1;\n  @property(cc.Float)\n  experience: number = 0;\n  expRequired: number = 0;\n  @property(cc.AudioClip)\n  levelUpSound: cc.AudioClip = null;\n  addExperience(amount: number) {\n    amount += (amount * OverallStats.instance.getBonusExpRate()) / 100;\n    this.experience += amount;\n  }\n  calculateNextLevel() {\n    const currentLevel = this.level;\n    const nextLevel = currentLevel + 1;\n    const element1 = Math.pow(4 * nextLevel, 2.1);\n    const element2 = Math.pow(4 * currentLevel, 2.1);\n    const roundedElement1 = Math.round(element1);\n    const roundedElement2 = Math.round(element2);\n    this.expRequired = roundedElement1 - roundedElement2;\n  }\n  // calculateNextLevelTest(current) {\n  //   const currentLevel = current;\n  //   const nextLevel = currentLevel + 1;\n  //   const element1 = Math.pow(4 * nextLevel, 2.1);\n  //   const element2 = Math.pow(4 * currentLevel, 2.1);\n  //   const roundedElement1 = Math.round(element1);\n  //   const roundedElement2 = Math.round(element2);\n  //   var required = roundedElement1 - roundedElement2;\n  //   console.log(required);\n  // }\n  checkLevelUp() {\n    if (this.experience >= this.expRequired) {\n      if (Utils.getLocal(\"Sound\") == \"true\")\n        cc.audioEngine.play(this.levelUpSound, false, 1);\n      var expLeft = this.experience - this.expRequired;\n      this.level += 1;\n      this.expRequired = this.expRequired * 1.2;\n      this.experience = expLeft;\n      this.calculateNextLevel();\n      GameController.instance.onLevelUp();\n    }\n    var levelString = \"LEVEL \" + this.level;\n    UIController.instance.updateExp(\n      levelString,\n      this.expRequired,\n      this.experience\n    );\n  }\n  onLoad() {\n    Level.instance = this;\n    this.calculateNextLevel();\n  }\n\n  start() {}\n\n  update(dt) {\n    if (Utils.isPause) return;\n    this.checkLevelUp();\n  }\n}\n"]}