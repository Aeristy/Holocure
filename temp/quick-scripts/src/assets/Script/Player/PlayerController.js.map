{"version":3,"sources":["assets\\Script\\Player\\PlayerController.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport GameController from \"../Controller/GameController\";\nimport UIController from \"../Controller/UIController\";\nimport Utils from \"../Controller/Utils\";\nimport EnemyController from \"../Enemy/EnemyController\";\nimport BaneOfRegeneration from \"../Item/BaneOfRegeneration\";\nimport DeathHeart from \"../Other Object/DeathHeart\";\nimport StartWeapon from \"../Weapon/StartWeapon\";\nimport Weapon from \"../Weapon/Weapon\";\nimport HealthAndShield from \"./HealthAndShield\";\nimport OverallStats from \"./OverallStats\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class PlayerController extends cc.Component {\n  static instance: PlayerController;\n  @property(cc.JsonAsset)\n  dataPlayer: cc.JsonAsset = null;\n  @property(cc.Prefab)\n  deathHeart: cc.Prefab = null;\n  speed = 1;\n  maxHp = 100;\n  currentHp;\n  maxShield = 0;\n  currentShield: number;\n  @property(cc.Float)\n  iFrameDuration = 0.3;\n  pickupRange = 100;\n  resist = 0;\n  @property(cc.Boolean)\n  enableIframe: boolean = false;\n  @property(cc.Boolean)\n  isUnkilled: boolean = false;\n  baseSpd: number;\n  baseMaxHp: number;\n  basePR: number;\n  baseResist: number;\n  isIFrame: boolean;\n  iFrametimer: number;\n  isMoving: boolean;\n  anim: cc.Animation;\n  animList;\n  deltaTime: number;\n  overallStat: OverallStats;\n  loadedData;\n  @property(Array(cc.Prefab))\n  characterPrefab: Array<cc.Prefab> = Array<cc.Prefab>();\n  @property(cc.AudioClip)\n  hurtSound: cc.AudioClip = null;\n  @property(cc.AudioClip)\n  deadSound: cc.AudioClip = null;\n  @property(cc.AudioClip)\n  healSound: cc.AudioClip = null;\n  startWeapon: string;\n  onLoad() {\n    PlayerController.instance = this;\n    this.overallStat = OverallStats.instance;\n    this.basePR = this.pickupRange;\n    this.baseResist = this.resist;\n    this.loadCharacter();\n    this.node.parent.zIndex = 10000;\n    this.isIFrame = false;\n    this.isMoving = false;\n    this.iFrametimer = 0;\n  }\n  loadCharacter() {\n    let characterLevel = Utils.getCharacterLevel();\n    for (let i = 0; i < this.characterPrefab.length; i++) {\n      if (Utils.getCharacterByName() == this.characterPrefab[i].name) {\n        let character = cc.instantiate(this.characterPrefab[i]);\n        character.parent = this.node;\n        UIController.instance.setPortrait(i);\n        this.loadedData =\n          this.dataPlayer.json.character[i].stats[characterLevel - 1];\n        this.startWeapon = this.dataPlayer.json.character[i].weapon;\n        this.baseMaxHp = this.loadedData.health;\n        this.maxHp = this.baseMaxHp;\n        this.currentHp = this.maxHp;\n        this.baseSpd = this.loadedData.speed;\n\n        // this.overallStat.increaseAttackRate(data.atk);\n        // this.overallStat.increaseCritChance(data.crit);\n      }\n    }\n    this.anim = this.getComponentInChildren(cc.Animation);\n    this.animList = this.anim.getClips();\n    this.anim.play(this.animList[0]);\n    this.currentShield = this.maxShield;\n    HealthAndShield.instance.setStateOnLoad(\n      this.currentHp,\n      this.maxHp,\n      this.currentShield,\n      this.maxShield\n    );\n    this.onStatChange();\n    this.node.getComponent(cc.CircleCollider).radius = this.pickupRange;\n  }\n  start() {\n    this.node.parent\n      .getChildByName(\"StartWeapon\")\n      .getChildByName(this.startWeapon)\n      .getComponent(StartWeapon).level++;\n  }\n  takeDamage(damage: number) {\n    if (this.isIFrame) return;\n    if (this.isUnkilled) return;\n    if (Utils.getLocal(\"Sound\") == \"true\")\n      cc.audioEngine.play(this.hurtSound, false, 1);\n    damage -= (damage * this.resist) / 100;\n    var damageLeft = this.currentShield - damage;\n    this.currentShield -= damage;\n    if (this.currentShield < 0) this.currentShield = 0;\n\n    if (damageLeft < 0) {\n      this.currentHp += damageLeft;\n      HealthAndShield.instance.setStateHP(this.currentHp, this.maxHp);\n      GameController.instance.takeDamage();\n    }\n    if (this.enableIframe) {\n      this.isIFrame = true;\n      this.iFrametimer = this.iFrameDuration;\n    }\n    HealthAndShield.instance.setStateShield(this.currentShield, this.maxShield);\n    if (this.currentHp <= 0) {\n      if (Utils.getLocal(\"Sound\") == \"true\")\n        cc.audioEngine.play(this.deadSound, false, 1);\n      this.currentHp = 0;\n      HealthAndShield.instance.setStateHP(this.currentHp, this.maxHp);\n      for (let x = -1; x <= 1; x++) {\n        for (let y = -1; y <= 1; y += 0.25) {\n          let deathHeart = cc.instantiate(this.deathHeart);\n          deathHeart.position = this.node.position;\n          deathHeart.parent = this.node.parent;\n          deathHeart.getComponent(DeathHeart).vec2 = cc.v2(x, y);\n        }\n      }\n      GameController.instance.onGameOver();\n      this.node.destroy();\n    }\n  }\n  onStatChange() {\n    var oldMaxHP = this.maxHp;\n    this.maxHp =\n      (this.baseMaxHp * this.overallStat.getMaxHPRate()) / 100 + this.baseMaxHp;\n    this.currentHp += this.maxHp - oldMaxHP;\n    this.resist = this.overallStat.getResistRate() + this.baseResist;\n    if (this.resist > 100) this.resist = 100;\n    this.pickupRange =\n      (this.basePR * this.overallStat.getPickupRangeRate()) / 100 + this.basePR;\n    this.node.getComponent(cc.CircleCollider).radius = this.pickupRange;\n    this.speed =\n      (this.baseSpd * this.overallStat.getSpeedRate()) / 100 + this.baseSpd;\n    HealthAndShield.instance.setStateOnLoad(\n      this.currentHp,\n      this.maxHp,\n      this.currentShield,\n      this.maxShield\n    );\n  }\n  gainMaxShield(amount: number) {\n    this.maxShield += amount;\n    this.currentShield += amount;\n    HealthAndShield.instance.setStateOnLoad(\n      this.currentHp,\n      this.maxHp,\n      this.currentShield,\n      this.maxShield\n    );\n  }\n  gainShield(amount: number) {\n    this.currentShield += amount;\n    if (this.currentShield > this.maxShield)\n      this.currentShield = this.maxShield;\n    HealthAndShield.instance.setStateOnLoad(\n      this.currentHp,\n      this.maxHp,\n      this.currentShield,\n      this.maxShield\n    );\n  }\n  heal(healAmount: number) {\n    if (this.currentHp <= 0) return;\n    if (this.currentHp == this.maxHp) return;\n    this.currentHp +=\n      healAmount + (healAmount / 100) * this.overallStat.getBonusHealingRate();\n    if (this.currentHp > this.maxHp) {\n      this.currentHp = this.maxHp;\n    }\n    HealthAndShield.instance.setStateHP(Math.ceil(this.currentHp), this.maxHp);\n    if (Utils.getLocal(\"Sound\") == \"true\")\n      cc.audioEngine.play(this.healSound, false, 1);\n  }\n  regenHP(healAmount: number) {\n    if (this.currentHp <= 0) return;\n    if (this.currentHp == this.maxHp) return;\n    this.currentHp +=\n      healAmount + (healAmount / 100) * this.overallStat.getBonusHealingRate();\n    if (this.currentHp > this.maxHp) {\n      this.currentHp = this.maxHp;\n    }\n    HealthAndShield.instance.setStateOnLoad(\n      Math.ceil(this.currentHp),\n      this.maxHp,\n      this.currentShield,\n      this.maxShield\n    );\n  }\n  healByPercentage(healPercentage: number) {\n    if (this.currentHp <= 0) return;\n    if (this.currentHp == this.maxHp) return;\n    this.currentHp +=\n      (this.maxHp / 100) *\n      (healPercentage +\n        (healPercentage / 100) * this.overallStat.getBonusHealingRate());\n\n    if (this.currentHp > this.maxHp) {\n      this.currentHp = this.maxHp;\n    }\n    HealthAndShield.instance.setStateHP(Math.ceil(this.currentHp), this.maxHp);\n    if (Utils.getLocal(\"Sound\") == \"true\")\n      cc.audioEngine.play(this.healSound, false, 1);\n  }\n  runAnimation() {\n    if (\n      !this.anim.getAnimationState(this.animList[1].name).isPlaying &&\n      this.isMoving == true\n    ) {\n      this.anim.play(this.animList[1].name);\n    }\n    if (\n      this.isMoving == false &&\n      !this.anim.getAnimationState(this.animList[0].name).isPlaying\n    ) {\n      this.anim.play(this.animList[0].name);\n    }\n  }\n\n  update(dt) {\n    if (Utils.isPause) {\n      this.anim.pause();\n      return;\n    }\n    this.anim.resume();\n    this.deltaTime = dt;\n    this.iFrametimer -= dt;\n    if (this.iFrametimer < 0) {\n      this.enableIframe = false;\n      this.isIFrame = false;\n    }\n    this.runAnimation();\n  }\n}\n"]}