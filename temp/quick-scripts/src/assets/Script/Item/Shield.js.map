{"version":3,"sources":["assets\\Script\\Item\\Shield.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport GameController from \"../Controller/GameController\";\nimport Utils from \"../Controller/Utils\";\nimport OverallStats from \"../Player/OverallStats\";\nimport PlayerController from \"../Player/PlayerController\";\nimport Item from \"./Item\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class Shield extends Item {\n  static instance: Shield;\n  @property(cc.Float)\n  baseShield: number = 15;\n  @property(cc.Float)\n  baseResist: number = 5;\n  @property(cc.Float)\n  refreshTimer: number = 15;\n  timer: number = this.refreshTimer;\n  player: PlayerController;\n  currentLevel = this.level;\n  onLoad() {\n    Shield.instance = this;\n    GameController.instance.dynamicBuff.push(this);\n    this.itemOnLoad();\n    this.description =\n      \"Gain a shield that absorbs up to 15 damage. Every 15 seconds, this shield refreshes. Also reduces damage taken by 5%.\";\n  }\n  refreshShield(dt: number) {\n    if (this.player.currentShield < this.player.maxShield) {\n      this.timer -= dt;\n      if (this.timer < 0) {\n        this.timer = this.refreshTimer;\n        this.player.gainShield(this.baseShield);\n      }\n    } else {\n      this.timer = this.refreshTimer;\n    }\n  }\n  onTakeDamage() {\n    this.timer = 15;\n  }\n  updateStats(shieldAmount: number, resistAmount: number) {\n    this.baseShield += shieldAmount;\n    OverallStats.instance.increaseResistRate(resistAmount);\n    this.addShieldToPlayer(shieldAmount);\n  }\n  loadStats() {\n    OverallStats.instance.increaseResistRate(this.baseResist);\n    this.addShieldToPlayer(this.baseShield);\n  }\n  onLevelUp() {\n    if (this.isLockLevel) return;\n    if (this.currentLevel < this.level) {\n      this.onLevelMax();\n      this.currentLevel = this.level;\n      switch (this.level) {\n        case 1:\n          this.loadStats();\n          this.description =\n            \"Gain a shield that absorbs up to 20 damage. Every 15 seconds, this shield refreshes. Also reduces damage taken by 10%.\";\n          this.isEquiped = true;\n          GameController.instance.addEquipedItem(this);\n          break;\n        case 2:\n          this.description =\n            \"Gain a shield that absorbs up to 25 damage. Every 15 seconds, this shield refreshes. Also reduces damage taken by 15%.\";\n          this.updateStats(5, 5);\n          break;\n        case 3:\n          this.description =\n            \"Gain a shield that absorbs up to 30 damage. Every 15 seconds, this shield refreshes. Also reduces damage taken by 20%.\";\n          this.updateStats(5, 5);\n          break;\n        case 4:\n          this.description =\n            \"Gain a shield that absorbs up to 35 damage. Every 15 seconds, this shield refreshes. Also reduces damage taken by 25%.\";\n          this.updateStats(5, 5);\n          break;\n        case 5:\n          this.updateStats(5, 5);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n\n  addShieldToPlayer(shield: number) {\n    this.player.gainMaxShield(shield);\n  }\n  start() {\n    this.player = PlayerController.instance;\n  }\n\n  update(dt) {\n    this.onLevelUp();\n    if (Utils.isPause) return;\n    if (!this.isEquiped) return;\n    this.refreshShield(dt);\n  }\n}\n"]}