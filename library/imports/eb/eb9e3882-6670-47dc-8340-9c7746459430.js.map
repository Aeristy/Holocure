{"version":3,"sources":["assets\\Script\\Manager\\ObjectPooling.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport Coin from \"../Other Object/Coin\";\nimport Experience from \"../Other Object/Experience\";\nimport Food from \"../Other Object/Food\";\nimport Magnet from \"../Other Object/Magnet\";\nimport Pickup from \"../Other Object/Pickup\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class objectPooling extends cc.Component {\n  static instance: objectPooling;\n  @property(Array(cc.Prefab))\n  expPrefab: Array<cc.Prefab> = new Array<cc.Prefab>();\n  @property(cc.Prefab)\n  coinPrefab: cc.Prefab = null;\n  @property(cc.Prefab)\n  foodPrefab: cc.Prefab = null;\n  @property(cc.Prefab)\n  rainbowExpPrefab: cc.Prefab = null;\n  @property(cc.Node)\n  gameplay: cc.Node = null;\n  expPool: Array<cc.NodePool> = new Array<cc.NodePool>();\n  coinPool: cc.NodePool = new cc.NodePool();\n  foodPool: cc.NodePool = new cc.NodePool();\n  rainbowExpPool: cc.NodePool = new cc.NodePool();\n  expList: Array<cc.Node> = new Array<cc.Node>();\n  coinList: Array<cc.Node> = new Array<cc.Node>();\n  magnetList: Array<cc.Node> = new Array<cc.Node>();\n  onLoad() {\n    objectPooling.instance = this;\n    this.addToArrayPool();\n    let initCount = 500;\n    for (let j = 0; j < this.expPool.length; j++) {\n      for (let i = 0; i < initCount; ++i) {\n        let exp = cc.instantiate(this.expPrefab[j]);\n        this.expPool[j].put(exp);\n      }\n    }\n  }\n  start() {}\n\n  addToArrayPool() {\n    for (let i = 0; i < this.expPrefab.length; i++) {\n      var expType = new cc.NodePool();\n      this.expPool.push(expType);\n    }\n  }\n  generateExp(node: cc.Node, expGained: number) {\n    let exp: cc.Node = null;\n    let type: number = null;\n    if (expGained > 0) type = 1;\n    if (expGained > 10) type = 2;\n    if (expGained > 19) type = 3;\n    if (expGained > 49) type = 4;\n    if (expGained > 99) type = 5;\n    if (expGained > 200) type = 6;\n\n    if (this.expPool[type - 1].size() > 0) {\n      exp = this.expPool[type - 1].get();\n    } else {\n      exp = cc.instantiate(this.expPrefab[type - 1]);\n    }\n    exp.getComponent(Experience).set(expGained);\n    exp.getComponent(Pickup).set();\n    this.addToExpList(exp);\n    exp.parent = this.gameplay;\n    exp.position = node.position;\n  }\n  generateCoin(node: cc.Node, amount: number) {\n    let coin: cc.Node = null;\n    if (this.coinPool.size() > 0) {\n      coin = this.coinPool.get();\n    } else {\n      coin = cc.instantiate(this.coinPrefab);\n    }\n    coin.getComponent(Coin).set(amount);\n    coin.getComponent(Pickup).set();\n    this.addToCoinList(coin);\n    coin.parent = this.gameplay;\n    coin.position = node.position;\n  }\n  generateFood(node: cc.Node) {\n    let food: cc.Node = null;\n    if (this.foodPool.size() > 0) {\n      food = this.foodPool.get();\n    } else {\n      food = cc.instantiate(this.foodPrefab);\n    }\n    food.getComponent(Pickup).set();\n    food.parent = this.gameplay;\n    food.position = node.position;\n  }\n  generateMagnet(node: cc.Node) {\n    let magnet: cc.Node = null;\n    this.addToMagnetList(magnet);\n    magnet = cc.instantiate(this.rainbowExpPrefab);\n    magnet.getComponent(Pickup).set();\n    magnet.parent = this.gameplay;\n    magnet.position = node.position;\n  }\n  addToExpList(node: cc.Node) {\n    this.expList.push(node);\n  }\n  addToCoinList(node: cc.Node) {\n    this.coinList.push(node);\n  }\n  addToMagnetList(node: cc.Node) {\n    this.magnetList.push(node);\n  }\n  putBackToPool(node: cc.Node) {\n    if (!node) return;\n    switch (node.name) {\n      case \"Exp1\":\n        this.expPool[0].put(node);\n        break;\n      case \"Exp2\":\n        this.expPool[1].put(node);\n        break;\n      case \"Exp3\":\n        this.expPool[2].put(node);\n        break;\n      case \"Exp4\":\n        this.expPool[3].put(node);\n        break;\n      case \"Exp5\":\n        this.expPool[4].put(node);\n        break;\n      case \"Exp6\":\n        this.expPool[5].put(node);\n        break;\n      case \"Coin\":\n        this.coinPool.put(node);\n        break;\n      case \"Food\":\n        this.foodPool.put(node);\n        break;\n    }\n  }\n  removeFromList() {\n    this.expList = this.expList.filter(\n      (item) => item.getComponent(Experience).isLooted !== true\n    );\n    this.coinList = this.coinList.filter(\n      (item) => item.getComponent(Coin).isLooted !== true\n    );\n  }\n  onMagnetPickup() {\n    this.expList.forEach((element) => {\n      element.getComponent(Pickup).isPicking = true;\n    });\n    this.coinList.forEach((element) => {\n      element.getComponent(Pickup).isPicking = true;\n    });\n    this.magnetList.forEach((element) => {\n      if (element != null && element.active)\n        element.getComponent(Pickup).isPicking = true;\n    });\n  }\n  protected update(dt: number): void {\n    this.removeFromList();\n  }\n}\n"]}