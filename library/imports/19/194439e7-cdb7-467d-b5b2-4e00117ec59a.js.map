{"version":3,"sources":["assets\\Script\\Item\\BloodyTear.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport GameController from \"../Controller/GameController\";\nimport Utils from \"../Controller/Utils\";\nimport PlayerController from \"../Player/PlayerController\";\nimport Item from \"./Item\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class BloodyTear extends Item {\n  static instance: BloodyTear;\n  @property(cc.Float)\n  healingAmount: number = 2;\n  @property(cc.Float)\n  healingChance: number = 30;\n  @property(cc.Float)\n  refreshTimer: number = 0.25;\n  timer: number = 0.25;\n  player: PlayerController;\n  killCount: number = 0;\n  currentLevel = this.level;\n  onLoad() {\n    BloodyTear.instance = this;\n    this.itemOnLoad();\n    this.player = PlayerController.instance;\n    this.description =\n      \"When defeating a target, there is a 30% chance to life-steal 2 HP.\";\n  }\n\n  start() {}\n  updateStats(additionHealingAmount: number, additionHealingChange: number) {\n    this.healingAmount += additionHealingAmount;\n    this.healingChance += additionHealingChange;\n  }\n  onLevelUp() {\n    if (this.isLockLevel) return;\n    if (this.currentLevel < this.level) {\n      this.onLevelMax();\n      this.currentLevel = this.level;\n      switch (this.level) {\n        case 1:\n          this.description =\n            \"When defeating a target, there is a 30% chance to life-steal 4 HP.\";\n          this.isEquiped = true;\n          GameController.instance.addEquipedItem(this);\n          break;\n        case 2:\n          this.description =\n            \"When defeating a target, there is a 30% chance to life-steal 6 HP.\";\n          this.updateStats(2, 0);\n          break;\n        case 3:\n          this.updateStats(2, 0);\n          break;\n        default:\n          break;\n      }\n    }\n  }\n  healPlayer(dt: number) {\n    this.timer -= dt;\n    if (this.timer < 0) {\n      if (this.killCount != GameController.instance.killAmount) {\n        this.timer = this.refreshTimer;\n        this.killCount = GameController.instance.killAmount;\n        var healChange = this.healingChance / 100;\n        var random = Math.random();\n\n        if (random < healChange) {\n          this.player.heal(this.healingAmount);\n        }\n      }\n    }\n  }\n  update(dt) {\n    this.onLevelUp();\n    if (Utils.isPause) return;\n    if (!this.isEquiped) return;\n    this.healPlayer(dt);\n  }\n}\n"]}